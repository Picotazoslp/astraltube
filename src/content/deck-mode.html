<!DOCTYPE html>
<div class="deck-header">
    <div class="deck-title">
        <div class="deck-logo">
            <img src="${chrome.runtime.getURL('icons/icon32.png')}" alt="AstralTube">
            <h1>AstralTube Deck Mode</h1>
        </div>
        <div class="deck-controls">
            <button id="add-column-btn" class="deck-btn primary" title="Add Column" aria-label="Add new column">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 1v6h6v2H8v6H6V9H0V7h6V1h2z"/>
                </svg>
                <span>Add Column</span>
            </button>
            <button id="deck-settings-btn" class="deck-btn" title="Deck Settings" aria-label="Open deck settings">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 4.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM5.5 7a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z"/>
                    <path d="M14 7a7 7 0 11-14 0 7 7 0 0114 0zM1 7a6 6 0 1012 0A6 6 0 001 7z"/>
                </svg>
                <span>Settings</span>
            </button>
            <button id="fullscreen-btn" class="deck-btn" title="Toggle Fullscreen" aria-label="Toggle fullscreen mode">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M1 1h4v2H3v2H1V1zm10 0h4v4h-2V3h-2V1zM1 11v4h4v-2H3v-2H1zm14 4h-4v-2h2v-2h2v4z"/>
                </svg>
                <span>Fullscreen</span>
            </button>
            <button id="exit-deck-btn" class="deck-btn danger" title="Exit Deck Mode" aria-label="Exit deck mode">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M4.646 4.646a.5.5 0 01.708 0L8 7.293l2.646-2.647a.5.5 0 01.708.708L8.707 8l2.647 2.646a.5.5 0 01-.708.708L8 8.707l-2.646 2.647a.5.5 0 01-.708-.708L7.293 8 4.646 5.354a.5.5 0 010-.708z"/>
                </svg>
                <span>Exit</span>
            </button>
        </div>
    </div>
    <div class="deck-toolbar">
        <div class="deck-stats" id="deck-stats" aria-live="polite">
            <span class="stat-item" id="column-count">0 columns</span>
            <span class="stat-item" id="last-updated">Last updated: Never</span>
            <span class="stat-item" id="total-items">0 items</span>
        </div>
        <div class="deck-actions">
            <button id="refresh-all-btn" class="toolbar-btn" title="Refresh All Columns" aria-label="Refresh all columns">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                    <path d="M13 7a6 6 0 01-6 6v-2a4 4 0 004-4h2zM1 7a6 6 0 016-6v2a4 4 0 00-4 4H1z"/>
                </svg>
                Refresh All
            </button>
            <div class="view-options">
                <label for="auto-refresh-toggle" class="checkbox-label">
                    <input type="checkbox" id="auto-refresh-toggle" checked>
                    <span class="checkbox-custom"></span>
                    Auto Refresh
                </label>
            </div>
            <div class="layout-controls">
                <button id="compact-view-btn" class="view-toggle" title="Compact View" aria-label="Toggle compact view">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                        <rect x="1" y="2" width="12" height="1"/>
                        <rect x="1" y="6" width="12" height="1"/>
                        <rect x="1" y="10" width="12" height="1"/>
                    </svg>
                </button>
                <button id="layout-settings-btn" class="view-toggle" title="Layout Settings" aria-label="Open layout settings">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                        <rect x="1" y="1" width="4" height="4"/>
                        <rect x="7" y="1" width="6" height="2"/>
                        <rect x="7" y="4" width="6" height="1"/>
                        <rect x="1" y="8" width="12" height="1"/>
                        <rect x="1" y="11" width="12" height="1"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="deck-main">
    <div class="deck-columns-container" id="deck-columns" role="main" aria-label="Deck columns">
        <!-- Dynamic columns will be inserted here -->
        <div class="deck-welcome" id="deck-welcome">
            <div class="welcome-content">
                <div class="welcome-icon">
                    <svg width="64" height="64" viewBox="0 0 64 64" fill="currentColor">
                        <rect x="8" y="12" width="16" height="40" rx="2"/>
                        <rect x="28" y="8" width="16" height="48" rx="2"/>
                        <rect x="48" y="16" width="16" height="32" rx="2"/>
                    </svg>
                </div>
                <h2>Welcome to Deck Mode</h2>
                <p>Add your first column to get started. Choose from subscriptions, trending, playlists, and more.</p>
                <button id="welcome-add-column" class="welcome-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 1v6h6v2H8v6H6V9H0V7h6V1h2z"/>
                    </svg>
                    Add Your First Column
                </button>
            </div>
        </div>
    </div>
    
    <!-- Column Templates (Hidden) -->
    <template id="column-template">
        <div class="deck-column" data-column-id="" data-column-type="">
            <div class="column-header">
                <div class="column-title">
                    <span class="column-icon"></span>
                    <span class="column-name"></span>
                    <span class="column-badge" style="display: none;"></span>
                </div>
                <div class="column-controls">
                    <button class="column-btn" data-action="refresh" title="Refresh Column" aria-label="Refresh this column">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M11 6a5 5 0 01-5 5v-1a4 4 0 004-4h1zM1 6a5 5 0 015-5v1a4 4 0 00-4 4H1z"/>
                        </svg>
                    </button>
                    <button class="column-btn" data-action="filter" title="Filter Content" aria-label="Filter column content">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M1 2h10l-4 5v3l-2-1V7L1 2z"/>
                        </svg>
                    </button>
                    <button class="column-btn" data-action="settings" title="Column Settings" aria-label="Open column settings">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M6 3.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM4.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z"/>
                        </svg>
                    </button>
                    <button class="column-btn" data-action="move-left" title="Move Left" aria-label="Move column left">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M8 2L4 6l4 4V2z"/>
                        </svg>
                    </button>
                    <button class="column-btn" data-action="move-right" title="Move Right" aria-label="Move column right">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M4 2l4 4-4 4V2z"/>
                        </svg>
                    </button>
                    <button class="column-btn danger" data-action="close" title="Remove Column" aria-label="Remove this column">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                            <path d="M9.707 2.293L6 6l3.707 3.707-1.414 1.414L4.586 7.414 1.879 10.121.465 8.707 3.172 6 .465 3.293 1.879 1.879 4.586 4.586 8.293.879l1.414 1.414z"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="column-filters" style="display: none;">
                <div class="filter-controls">
                    <input type="text" class="filter-search" placeholder="Filter content..." aria-label="Filter content">
                    <select class="filter-sort" aria-label="Sort content">
                        <option value="default">Default Order</option>
                        <option value="title">Title A-Z</option>
                        <option value="date">Newest First</option>
                        <option value="views">Most Popular</option>
                    </select>
                </div>
            </div>
            <div class="column-content" data-column-content>
                <div class="column-loading">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <span class="loading-text">Loading...</span>
                </div>
            </div>
            <div class="column-footer">
                <div class="column-stats">
                    <span class="item-count">0 items</span>
                    <span class="last-update">Never updated</span>
                </div>
                <div class="column-actions">
                    <button class="column-footer-btn" data-action="load-more" title="Load More" style="display: none;">
                        Load More
                    </button>
                </div>
            </div>
            <div class="column-resize-handle" title="Drag to resize"></div>
        </div>
    </template>
    
    <!-- Video Item Template -->
    <template id="video-item-template">
        <div class="column-item video-item" data-video-id="" tabindex="0" role="button">
            <div class="item-thumbnail-container">
                <img class="item-thumbnail" src="" alt="" loading="lazy">
                <div class="item-duration"></div>
                <div class="item-overlay">
                    <button class="overlay-btn play-btn" title="Play Video">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M4 2l8 6-8 6V2z"/>
                        </svg>
                    </button>
                    <button class="overlay-btn add-btn" title="Add to Playlist">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 1v6h6v2H8v6H6V9H0V7h6V1h2z"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="item-content">
                <div class="item-title"></div>
                <div class="item-meta">
                    <span class="item-channel"></span>
                    <span class="item-views"></span>
                    <span class="item-date"></span>
                </div>
                <div class="item-description"></div>
                <div class="item-actions">
                    <button class="item-action-btn" data-action="watch-later" title="Add to Watch Later">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M6 1a5 5 0 100 10A5 5 0 006 1zM6 2.5L7.5 6H6V3.5z"/>
                        </svg>
                    </button>
                    <button class="item-action-btn" data-action="add-playlist" title="Add to Playlist">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M2 3h8v1H2V3zm0 3h8v1H2V6zm0 3h5v1H2V9z"/>
                        </svg>
                    </button>
                    <button class="item-action-btn" data-action="share" title="Share">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M8 1L3 4v1l5-3v2l4-3H8V1zM3 6v5l5-3V6L3 6z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </template>
    
    <!-- Playlist Item Template -->
    <template id="playlist-item-template">
        <div class="column-item playlist-item" data-playlist-id="" tabindex="0" role="button">
            <div class="item-thumbnail-container">
                <img class="item-thumbnail" src="" alt="" loading="lazy">
                <div class="playlist-count"></div>
            </div>
            <div class="item-content">
                <div class="item-title"></div>
                <div class="item-meta">
                    <span class="item-privacy"></span>
                    <span class="item-video-count"></span>
                    <span class="item-date"></span>
                </div>
                <div class="item-description"></div>
                <div class="item-actions">
                    <button class="item-action-btn" data-action="play-all" title="Play All">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M4 2l6 4-6 4V2z"/>
                        </svg>
                    </button>
                    <button class="item-action-btn" data-action="edit" title="Edit Playlist">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M8 1l3 3-6 6H2V7l6-6z"/>
                        </svg>
                    </button>
                    <button class="item-action-btn" data-action="share" title="Share">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M8 1L3 4v1l5-3v2l4-3H8V1z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </template>
    
    <!-- Channel Item Template -->
    <template id="channel-item-template">
        <div class="column-item channel-item" data-channel-id="" tabindex="0" role="button">
            <div class="item-thumbnail-container">
                <img class="item-thumbnail channel-avatar" src="" alt="" loading="lazy">
                <div class="subscriber-count"></div>
            </div>
            <div class="item-content">
                <div class="item-title"></div>
                <div class="item-meta">
                    <span class="item-subscribers"></span>
                    <span class="item-videos"></span>
                </div>
                <div class="item-description"></div>
                <div class="item-actions">
                    <button class="item-action-btn" data-action="visit" title="Visit Channel">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M6 1a5 5 0 100 10A5 5 0 006 1zM6 2.5v7A3.5 3.5 0 106 2.5z"/>
                        </svg>
                    </button>
                    <button class="item-action-btn" data-action="add-collection" title="Add to Collection">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M2 2h8a1 1 0 011 1v6a1 1 0 01-1 1H2a1 1 0 01-1-1V3a1 1 0 011-1z"/>
                        </svg>
                    </button>
                    <button class="item-action-btn" data-action="subscribe" title="Subscribe">
                        <svg width="12" height="12" fill="currentColor">
                            <path d="M6 1L1 4v5a2 2 0 002 2h6a2 2 0 002-2V4L6 1z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </template>
</div>

<div class="deck-footer">
    <div class="footer-left">
        <div class="deck-actions">
            <button id="save-layout-btn" class="footer-btn" title="Save Current Layout" aria-label="Save current layout">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                    <path d="M12 1H2a1 1 0 00-1 1v10a1 1 0 001 1h10a1 1 0 001-1V2a1 1 0 00-1-1zM8 11H3V6h5v5zM11 4H3V2h8v2z"/>
                </svg>
                Save Layout
            </button>
            <button id="load-layout-btn" class="footer-btn" title="Load Saved Layout" aria-label="Load saved layout">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                    <path d="M2 1h10a1 1 0 011 1v10a1 1 0 01-1 1H2a1 1 0 01-1-1V2a1 1 0 011-1zm8 2H4v8h6V3z"/>
                </svg>
                Load Layout
            </button>
            <button id="reset-layout-btn" class="footer-btn" title="Reset to Default Layout" aria-label="Reset to default layout">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                    <path d="M7 1a6 6 0 106 6h-1a5 5 0 11-5-5V1z"/>
                    <path d="M7 1L4 4h2v2h2V4h2L7 1z"/>
                </svg>
                Reset
            </button>
        </div>
    </div>
    
    <div class="footer-center">
        <div class="deck-status" id="deck-status" aria-live="polite" aria-atomic="true">
            Ready
        </div>
        <div class="performance-indicator" id="performance-indicator">
            <div class="perf-item">
                <span class="perf-label">CPU:</span>
                <span class="perf-value" id="cpu-usage">0%</span>
            </div>
            <div class="perf-item">
                <span class="perf-label">Memory:</span>
                <span class="perf-value" id="memory-usage">0MB</span>
            </div>
        </div>
    </div>
    
    <div class="footer-right">
        <div class="connection-status" id="connection-status" title="Connection Status">
            <div class="status-indicator">
                <div class="status-dot connected"></div>
                <span class="status-text">Connected</span>
            </div>
        </div>
        <div class="keyboard-shortcuts" title="Keyboard Shortcuts: Ctrl+Shift+D">
            <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>D</kbd>
        </div>
    </div>
</div>

<!-- Modals and Overlays -->
<div class="deck-modal" id="add-column-modal" style="display: none;" role="dialog" aria-labelledby="modal-title" aria-modal="true">
    <div class="modal-overlay" onclick="this.parentElement.style.display='none'"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title">Add New Column</h3>
            <button class="modal-close" onclick="this.closest('.deck-modal').style.display='none'" aria-label="Close modal">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M4.646 4.646a.5.5 0 01.708 0L8 7.293l2.646-2.647a.5.5 0 01.708.708L8.707 8l2.647 2.646a.5.5 0 01-.708.708L8 8.707l-2.646 2.647a.5.5 0 01-.708-.708L7.293 8 4.646 5.354a.5.5 0 010-.708z"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <div class="column-types-grid" id="column-types-grid">
                <!-- Column types will be populated dynamically -->
            </div>
        </div>
    </div>
</div>

<div class="deck-modal" id="column-settings-modal" style="display: none;" role="dialog" aria-labelledby="settings-title" aria-modal="true">
    <div class="modal-overlay" onclick="this.parentElement.style.display='none'"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="settings-title">Column Settings</h3>
            <button class="modal-close" onclick="this.closest('.deck-modal').style.display='none'" aria-label="Close modal">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M4.646 4.646a.5.5 0 01.708 0L8 7.293l2.646-2.647a.5.5 0 01.708.708L8.707 8l2.647 2.646a.5.5 0 01-.708.708L8 8.707l-2.646 2.647a.5.5 0 01-.708-.708L7.293 8 4.646 5.354a.5.5 0 010-.708z"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <div class="settings-form" id="column-settings-form">
                <!-- Settings form will be populated dynamically -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="this.closest('.deck-modal').style.display='none'">Cancel</button>
            <button class="btn-primary" id="save-column-settings">Save Changes</button>
        </div>
    </div>
</div>

<!-- Toast Notifications -->
<div class="toast-container" id="toast-container" aria-live="polite" aria-atomic="true">
    <!-- Toast notifications will be dynamically added here -->
</div>

<!-- Context Menu -->
<div class="context-menu" id="deck-context-menu" style="display: none;">
    <!-- Context menu items will be populated dynamically -->
</div>